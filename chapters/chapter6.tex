\chapter{常用工具与网址}\label{app1}

\section{Wiki}\label{app2}
\href{https://terraria.gamepedia.com/Terraria_Wiki}{英文} | \href{https://terraria-zh.gamepedia.com/Terraria_Wiki}{中文} | \href{http://terraria.1tu.me/}{中文镜像站} | \href{https://terraria-wiki.fileplanet.com/apk/download#}{英文apk}

\section{论坛}
\href{https://forums.terraria.org/index.php?forums/t-mec-terraria-mechanical-engineering-corps.194/}{官方论坛-[T-MEC]电路工程师联盟} | \href{https://github.com/putianyi889/TMECbackup}{T-MEC帖子存档} | \href{https://www.bbstr.net/}{中文论坛} | \href{https://www.curseforge.com/terraria/maps}{CurseForge地图下载}

\section{地图编辑器}\label{app3}
\href{https://github.com/TEdit/Terraria-Map-Editor}{主页} | \href{http://www.binaryconstruct.com/downloads/}{下载1} | \href{https://github.com/TEdit/Terraria-Map-Editor/releases}{下载2} | 推荐教程\href{http://v.youku.com/v_show/id_XMjYxNTUzOTMyOA}{(1)}\href{http://v.youku.com/v_show/id_XMjY0NDYwMTM3Ng}{(2)}\href{http://v.youku.com/v_show/id_XMjY1OTIzNjg4OA}{(3)}\href{http://v.youku.com/v_show/id_XMjY3ODQwODE1Ng}{(4)}

\section{模组}
\subsection{tModLoader}\label{app4}
\href{https://www.tmodloader.net/}{官网} | \href{https://github.com/tModLoader/tModLoader}{GitHub} | \href{https://github.com/tModLoader/tModLoader/releases}{下载} | \href{https://github.com/tModLoader/tModLoader/wiki}{Wiki} | \href{https://tmodloader.github.io/tModLoader/html/annotated.html}{文档}

\subsection{CheatSheet}\label{app5}
\href{https://github.com/JavidPack/CheatSheet}{主页} | \href{http://javid.ddns.net/tModLoader/download.php?Down=mods/CheatSheet.tmod}{下载1} | \href{https://github.com/JavidPack/CheatSheet/releases}{下载2} | \href{https://forums.terraria.org/index.php?threads/cheat-sheet.41407/}{发布页}

\subsection{HERO's Mod}\label{app6}
\href{https://github.com/JavidPack/HEROsMod}{主页} | \href{http://javid.ddns.net/tModLoader/download.php?Down=mods/HEROsMod.tmod}{下载1} | \href{https://github.com/JavidPack/HEROsMod/releases}{下载2} | \href{https://forums.terraria.org/index.php?threads/heros-mod-creative-mode-server-management-and-over-25-tools-1-3-4-4-compatible.44650/}{发布页}

\subsection{MechScope}\label{app7}
\href{https://github.com/DRKV333/MechScope}{主页} | \href{https://github.com/DRKV333/MechScope/releases/}{下载} | \href{https://forums.terraria.org/index.php?threads/mechscope-wiring-visualized.70665/}{发布页} | \href{https://www.bilibili.com/read/cv2222687}{中文介绍}

\section{源码}\label{app8}
\href{https://github.com/Pryaxis/Sources}{1.3.5各版本} | \href{https://github.com/NoviaDroid/TerrariaRefractoring_1.3.2.1}{1.3.2.1} | \href{https://github.com/saniainf/EDTerraria}{1.3} | \href{https://github.com/EdgeKiller/terrariaSource}{1.2.4.1} | \href{https://github.com/TheVamp/Terraria-Source-Code}{1.2.0.3.1} | \href{https://github.com/dptug/TerrariaXDK}{Xbox 360}

%\chapter{你应该知道的黑科技}
%\section{TNT神教}使用地图编辑器或mod将炸药或地雷放在宝箱下可以无限引爆。
%\section{传送器浮空}将家具放在传送机上，然后挖掉传送机下方的支撑方块，家具就可以浮空。有一些例外。
%\section{传送枪加速}手持传送枪时水平速度不变且无视上限，竖直速度有加成。经过传送门时速度大小不变。所以可以通过传送门将所有速度转化为水平速度，再利用重力提高竖直加速度从而增加总速度，反复进行这个过程，理论上可以无限加速。但是由于物理帧判定问题，实际操作非常困难，用简单装置只能加速到500mph左右。

\chapter{推荐视频}
\section{视觉效果}
\begin{itemize}
\item Terraria Bad Apple!! \url{https://www.bilibili.com/video/av46694445}
\item 【泰拉瑞亚】彩虹小电视我们起飞 \url{https://www.bilibili.com/video/av16601896}
\item {[}Terraria]官方推荐电路作品-Bad apple(音乐为后期添加) \url{https://www.bilibili.com/video/av22343683}
\item 【Terraria电路】像素盒定格动画 兔子 \url{https://www.bilibili.com/video/av50343156}
\item {[}Terraria] Digi-Comp 2装置展示-Zerogravitas \url{https://www.bilibili.com/video/av22690346}
\item 泰拉瑞亚 有趣的矿车 \url{https://www.bilibili.com/video/av5271577}
\item 【Terraria电路】给女朋友的生日礼物 \url{https://www.bilibili.com/video/av21009075/}
\item Terraria in-game Pixel Art Animation \url{https://www.bilibili.com/video/av5301176/?p=5}
\item Terraria 莫尔条纹动画 兔子 \url{https://www.bilibili.com/video/av49966963}
\item Terraria 电子钟 \url{https://www.bilibili.com/video/av55613747}
\item Terraria 异世界四重奏 ED『異世界ガールズ・トーク』（传送器定格动画） \url{https://www.bilibili.com/video/av54977071}
\end{itemize}

\section{解谜冒险}
\begin{itemize}
\item {[}Terraria]障碍挑战地图-Mappygaming \url{https://www.bilibili.com/video/av22787315}
\item 泰拉瑞亚 terraria 超难创意解谜地图通关介绍 （上） \url{https://www.bilibili.com/video/av19793617}
\item 泰拉瑞亚 terraria 超难创意解谜地图通关介绍 （中） \url{https://www.bilibili.com/video/av20101902}
\item 泰拉瑞亚 terraria 超难创意解谜地图通关介绍 （下） \url{https://www.bilibili.com/video/av20524074}
\item 泰拉瑞亚 在游戏里面玩游戏 \url{https://www.bilibili.com/video/av6594668}
\item {[}Terraria]使用传送枪达到最大速度!3000+mph! \url{https://www.bilibili.com/video/av24580434}
\item【Terraria】【FuryForged】冒险地图Harbinger通关实况 \url{https://www.bilibili.com/video/av37553671/}
\item 在Terraria中玩俄罗斯方块!? \url{https://www.bilibili.com/video/av38924330}
\item 在Terraria中解魔方? (Read Description) \url{https://www.bilibili.com/video/av56760618}
\end{itemize}

\section{刷怪刷物品}
\begin{itemize}
\item {[}Terraria]半砖松露蠕虫农场（390+条/小时）!-DicemanX \url{https://www.bilibili.com/video/av23029412}
\item 泰拉瑞亚-诈个尸 \url{https://www.bilibili.com/video/av13411383}
\item 泰拉瑞亚 雕像回血裸装专家月总 \url{https://www.bilibili.com/video/av6393957}
\item 【Terraria电路】【Joe Price】全自动刷怪场、刷BOSS合集 专家模式 \url{https://www.bilibili.com/video/av32865707/}
\item Terraria 1.3.1 Pumpkin Moon Final Wave at 806 pm, 255 platinum coins in a night \url{https://www.bilibili.com/video/av5356226/?p=5}
\item Terraria 1.3 Frost Moon Final Wave at 856 pm, 75820 Total Points - World Record \url{https://www.bilibili.com/video/av5356226/?p=6}
\item 【泰拉瑞亚】最快的boss击杀集锦 无法被超越的世界纪录？ \url{https://www.bilibili.com/video/av20725652}
\item 南瓜神教-旧日军团 \url{https://www.bilibili.com/video/av10885401/?p=3}
\item 南瓜神教-霜月夜 \url{https://www.bilibili.com/video/av10885401/?p=4}
\item 【Terraria电路】改进的高效全自动树场 \url{https://www.bilibili.com/video/av38882621/}
\item Terraria 刷石机 \url{https://www.bilibili.com/video/av50203346}
\item Terraria 水晶碎块农场 \url{https://www.bilibili.com/video/av57287619}
\end{itemize}

\chapter{待实现的电路或装置}

\section{电子钟}
原理很简单，使用假人驱动计数器。需要实现功能：精确到游戏秒，显示月相，进地图启动，使用日晷后会校正时间。可考虑的功能：12小时制与24小时制转化，自定义闹钟。

尽管有人已经做了一个电子钟\footnote{\url{https://www.bilibili.com/video/av55613747}}，但是它没有实现12小时与24小时转化功能与闹钟功能，也没有精确到游戏秒。

\section{确定有限状态自动机}
虽然确定有限自动机的组合逻辑构造与状态转换表有关，但是自动机的整体结构还没有一个优秀的可用方案。主要的难点可能在于接线，因为自动机中的线路是循环的，这违背了泰拉瑞亚中逻辑电路的一般规律。

\section{俄罗斯方块}
像素盒显示器的宽度限制是非常讨厌的，这使它无法实现我们一般习惯的横向显示器。另一方面，由于宽度被限制在24格之内，其实际能显示的东西非常有限。俄罗斯方块是为数不多的像素盒显示器可以胜任的任务。经典的俄罗斯方块主显示屏宽10格，高20格。副显示屏用来显示下一个方块，2*4或4*2皆可。使用方向感应器控制。

有人已经做过俄罗斯方块了\footnote{\url{https://www.bilibili.com/video/av38924330}}，但是它不能变速，不能计分，操作也不方便。

\section{贪吃蛇}
贪吃蛇是像素盒显示器能胜任的另一个任务。其缺点是像素盒显示器是单色的，可能无法分辨身体和果实。屠宰场与 TheRedStoneCrafter 已经分别做了一些工作。

\section{魔方}
使用彩线灯泡做显示。

有人已经做过魔方了\footnote{\url{https://www.bilibili.com/video/av56760618}}，但是它操作极不方便。

\section{Flappy Bird}
虽然 TheRedStoneCrafter 已经做过了Flappy Bird\footnote{\url{https://www.bilibili.com/video/av24265449}}，但是其效果并不好，还原度可以更高。首先是人物控制，可以利用水+海神贝壳模拟 Flappy Bird 中的运动，用尖刺或木尖刺模拟障碍物，检测人物位置，当人物被击退时游戏结束。

虽然使用递次电路可以实现，但是其占地过大，使得纵向上每个单元至少占三格。使用1秒计时器串联是最节省空间，静态视觉效果最好的，但是其频率过低。

可以用蜂蜜中的飞镖模拟障碍物，但是飞镖在蜂蜜中几乎不可见，可以使用弹幕踏板激活其他光源或虚实化尖刺来提高视觉效果。使用飞镖的好处就是电路难度较低，只需要设计发射飞镖的电路，其余的动画效果都可以自动完成。

\section{2048}
使用四向操纵板操作。因为多位数显面积太大，用指数表示，0表示2，1表示4，2表示8，……，9表示1024，A表示2048。如果要超过2048，用b表示4096，c表示8192，d表示16384，E表示32768，F表示65536，G表示131072（可能的最大值）。

使用像素盒显示可以显示出移动动画，但是难度相当大。

\section{计算机}

\chapter{冷却时间机制}
有不少电路物品都有冷却时间。游戏使用一个大小为1000的列表（以下称为冷却列表）存储冷却中的图格及其剩余冷却时间，每帧中，整个列表中的剩余冷却时间减1，如果减到0则将该图格从冷却列表中删除。当有冷却时间的图格被激活，游戏尝试将该图格加入冷却列表，如果该图格已经存在冷却列表中，或者冷却列表已满，则加入失败，该图格激活失败。所以，不光图格正在冷却时无法激活，在整个冷却列表已满时也无法激活。

使用冷却时间机制的图格及其冷却时间如下表：
\begin{table}[!h]
\centering
\begin{tabular}{c|c}
图格名称&冷却时间/帧\\\hline\hline
炮台&30\\\hline
雪球发射器&10\\\hline
烟花盒&30\\\hline
烟花喷泉&30\\\hline
矿车轨道&5\\\hline
飞镖机关&200\\\hline
超级飞镖机关&200\\\hline
烈焰机关&200\\\hline
长矛机关&90\\\hline
尖球机关&300\\\hline
喷泉（机关）&200\\\hline
刷怪雕像&30\\\hline
刷物品雕像&600\\\hline
传送NPC雕像&300\\\hline
\end{tabular}
\end{table}

此外，还有一些图格没有冷却时间，但是也借用了冷却列表用来做倒计时，包括计时器和引爆器。

\chapter{机关射弹的生成和刷新机制}
射弹生成中的参数包括射弹坐标、射弹速度、射弹ID、伤害、击退，和其他所需参数。未经说明的情况下，长度单位为像素，时间单位为帧。例如，速度的单位为像素/帧。

游戏中活跃的射弹被存储在一个大小为1000的列表中。新生成射弹时，会将新的射弹放入列表中第一个空位；如果列表已满，则射弹不会生成（但是不代表与射弹生成并列的其他操作也会中止）。

射弹是通过每帧中的刷新操作前进的。所谓刷新操作，就是根据射弹当前的属性计算出射弹下一帧的属性并更新。例如，已知射弹当前坐标和射弹速度，则射弹下一帧的坐标是当前坐标+速度。不同的射弹在更新时做出的判断和操作各不相同，甚至某些射弹在一帧中会刷新多次。非穿墙的射弹每次刷新时，如果与某个青绿压力垫板碰撞，并且在刷新前未与该青绿压力垫板碰撞，那么会激活该青绿压力垫板。

射弹的销毁操作会将列表中该射弹位置清空。销毁操作发生的场合主要有：不穿墙的射弹击中实体块；射弹存在时间达到了生存期；射弹离开了地图；有限穿透的射弹达到了穿透上限。

之所以在电路教程里说这么详细，是因为有一些奇怪的情况需要解释。

首先需要注意的一点是，射弹激活青绿压力垫板只发生在刷新后，而不发生在生成后。而刷新时激活青绿压力垫板的条件包括“刷新前未碰撞”。这意味着如果一个射弹在生成时与青绿压力垫板碰撞，那么既不在生成后激活，又不满足刷新时的激活条件，则这个青绿压力垫板不会被激活。

一个更极端的例子是飞镖机关-青绿压力垫板的连锁反应。

\section{匀速直线运动的射弹及其速度大小}
飞镖机关的飞镖速度12，超级飞镖机关的飞镖速度12，彩纸炮的引导速度14，传送枪台的传送枪子弹速度93。

\section{抛射型射弹的运动机制}
电路产生的抛射型射弹有大炮和兔兔炮的炮弹、雪球发射器的雪球。这类抛射型射弹在生成后首先匀速直线运动一段时间（大炮和兔兔炮为17，雪球发射器为19），然后获得一个垂直方向的加速度（大炮和兔兔炮为0.28，雪球发射器为0.3），并且水平速度依指数衰减（大炮和兔兔炮为0.99，雪球发射器为0.98）。

\section{炮台发射的射弹的初速度方向}
炮台一共有9个朝向，其对应的速度方向如\autoref{}所示。

\section{射弹碰撞箱及初始生成位置}

\section{实验测定抛射射弹轨迹}

\chapter{网站代号}
\begin{itemize}
\item bilibili \url{https://www.bilibili.com/}
\item 优酷 \url{http://www.youku.com/}
\item 官方论坛 \url{https://forums.terraria.org/index.php?forums/}
\item 中文论坛 \url{https://www.bbstr.net/}
\end{itemize}

\chapter{人名代号}
这个附录中包含了本书中提及的人名对应的论坛账号，以及本书写作过程中参考过的作者。
\begin{itemize}
\item putianyi888
\begin{itemize}
\item bilibili：\url{https://space.bilibili.com/34937101}
\item 官方论坛：\url{https://forums.terraria.org/index.php?members/putianyi888.121300/}
\item 百度贴吧：\url{http://tieba.baidu.com/home/main?un=putianyi888}
\item 中文论坛：\url{https://www.bbstr.net/members/putianyi888.342/}
\item YouTube：\url{https://www.youtube.com/channel/UCsG1EimffDYWXBoZRekcMIA}
\end{itemize}
\item usdanger
\begin{itemize}
    \item bilibili：\url{https://space.bilibili.com/34637318/}
    \item 优酷：\url{http://i.youku.com/u/UMTcyMDA1MTY4}
    \item 百度贴吧：\url{http://tieba.baidu.com/home/main?un=us_danger}
    \item YouTube：\url{https://www.youtube.com/channel/UCh_cLX4iAbM6tAIl0zu3elw}
\end{itemize}
\item dcfhft
\begin{itemize}
    \item bilibili：\url{https://space.bilibili.com/98605295/}
    \item 百度贴吧：\url{http://tieba.baidu.com/home/main?un=dcfhft}
    \item 官方论坛：
    \item 中文论坛：\url{https://www.bbstr.net/members/dcfhft.135/}
\end{itemize}
\item 屠宰场
\begin{itemize}
    \item bilibili：\url{https://space.bilibili.com/35610991/}
\end{itemize}
\item 沉睡
\begin{itemize}
    \item bilibili：\url{https://space.bilibili.com/22871583/}
\end{itemize}
\item 白霜心
\begin{itemize}
    \item bilibili：\url{https://space.bilibili.com/49886444/}
    \item 优酷：\url{http://i.youku.com/u/UMTMyOTg1ODM4OA}
    \item 百度贴吧：\url{http://tieba.baidu.com/home/main?un=白霜心}
\end{itemize}
\item TNoName
\begin{itemize}
    \item bilibili：\url{https://space.bilibili.com/14462041/}
    \item 中问论坛：\url{https://www.bbstr.net/members/tnoname.423/}
\end{itemize}
\item 机锋哥
\begin{itemize}
    \item 优酷：\url{http://i.youku.com/u/UMjg3MTI2NDcwOA}
\end{itemize}
\item ZeroGravitas
\begin{itemize}
    \item 官方论坛：\url{https://forums.terraria.org/index.php?members/zerogravitas.96/}
    \item YouTube：\url{https://www.youtube.com/channel/UCyLQbVwYleCYzgl49dNAeOw}
\end{itemize}
\item Programmatic
\begin{itemize}
    \item 官方论坛：\url{https://forums.terraria.org/index.php?members/programmatic.37545/}
    \item YouTube：\url{https://www.youtube.com/channel/UCWGTYKTR5Kw3cDhyd2vIDew}
\end{itemize}
\item TheRedStoneCrafter
\begin{itemize}
    \item 官方论坛：\url{https://forums.terraria.org/index.php?members/idkwhoiam129.57457/}
    \item YouTube：\url{https://www.youtube.com/channel/UC9ekQoOvO3BgFQsmGdWJpCQ}
\end{itemize}
\item ekinator
\begin{itemize}
    \item 官方论坛：\url{https://forums.terraria.org/index.php?members/ekinator.61186/}
\end{itemize}
\item DRKV
\begin{itemize}
    \item 官方论坛：\url{https://forums.terraria.org/index.php?members/drkv.67603/}
\end{itemize}
\item DicemanX
\begin{itemize}
    \item 官方论坛：\url{https://forums.terraria.org/index.php?members/dicemanx.1706/}
    \item YouTube：\url{https://www.youtube.com/channel/UCllYBm-_FbqWuI92o6zPXfw}
\end{itemize}
\item MappyGaming
\begin{itemize}
    \item YouTube：\url{https://www.youtube.com/channel/UC-u6c7ppGML6icciJ0Q1oWQ}
\end{itemize}
\end{itemize}