\chapter{机关射弹的生成和刷新机制}
\begin{note}
本机制属于1.3.5.3版本。
\end{note}

射弹生成中的参数包括射弹坐标、射弹速度、射弹ID、伤害、击退，和其他所需参数。未经说明的情况下，长度单位为像素，时间单位为帧。例如，速度的单位为像素/帧。

游戏中活跃的射弹被存储在一个大小为1000的列表中。新生成射弹时，会将新的射弹放入列表中第一个空位；如果列表已满，则射弹不会生成（但是不代表与射弹生成并列的其他操作也会中止）。

射弹是通过每帧中的刷新操作前进的。所谓刷新操作，就是根据射弹当前的属性计算出射弹下一帧的属性并更新。例如，已知射弹当前坐标和射弹速度，则射弹下一帧的坐标是当前坐标+速度。不同的射弹在更新时做出的判断和操作各不相同，甚至某些射弹在一帧中会刷新多次。非穿墙的射弹每次刷新时，如果与某个青绿压力垫板碰撞，并且在刷新前未与该青绿压力垫板碰撞，那么会激活该青绿压力垫板。

射弹的销毁操作会将列表中该射弹位置清空。销毁操作发生的场合主要有：不穿墙的射弹击中实体块；射弹存在时间达到了生存期；射弹离开了地图；有限穿透的射弹达到了穿透上限。

之所以在电路教程里说这么详细，是因为有一些奇怪的情况需要解释。

首先需要注意的一点是，射弹激活青绿压力垫板只发生在刷新后，而不发生在生成后。而刷新时激活青绿压力垫板的条件包括“刷新前未碰撞”。这意味着如果一个射弹在生成时与青绿压力垫板碰撞，那么既不在生成后激活，又不满足刷新时的激活条件，则这个青绿压力垫板不会被激活。

一个更极端的例子是飞镖机关-青绿压力垫板的连锁反应。

\section{匀速直线运动的射弹及其速度大小}
飞镖机关的飞镖速度12，超级飞镖机关的飞镖速度12，彩纸炮的引导速度14，传送枪台的传送枪子弹速度93。

\section{抛射型射弹的运动机制}
电路产生的抛射型射弹有大炮和兔兔炮的炮弹、雪球发射器的雪球。这类抛射型射弹在生成后首先匀速直线运动一段时间（大炮和兔兔炮为17，雪球发射器为19），然后获得一个垂直方向的加速度（大炮和兔兔炮为0.28，雪球发射器为0.3），并且水平速度依指数衰减（大炮和兔兔炮为0.99，雪球发射器为0.98）。

\section{射弹碰撞箱及初始生成位置}

\section{实验测定抛射射弹轨迹}